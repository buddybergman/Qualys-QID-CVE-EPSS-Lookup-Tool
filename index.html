<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lookup Tool for Qualys QID or CVE</title>
    <style>
        body {
            background-color: black;
            color: white;
            font-family: Arial, sans-serif;
        }

        table {
            border-collapse: collapse;
            width: 100%;
        }

        table, th, td {
            border: 1px solid white;
        }

        th, td {
            padding: 8px 12px;
        }

        h2, h3 {
            color: white;
        }

        input, button {
            padding: 6px 10px;
            margin: 5px 0;
            font-size: 14px;
        }
		/* Page Title */
		#pageTitle {
			text-decoration: underline;
		}
		/* Hide border for the search table */
		#searchTable, #searchTable th, #searchTable td {
			border: none;
		}
		#searchTable {
			width: 800px;
			border: 1px solid white;
			/*margin: 0 auto; /* This centers the table horizontally */*/
		}
		#header-cve, #header-cve-cve {
			width: 130px;  /* Adjust this value as per your requirement */
		}
		.header-container {
			display: flex;
			justify-content: space-between;
			align-items: center;
		}
		#dataLoading {
			color: red;
		}
		#loadable {
			color: #D9D6D6;
		}		

    </style>
</head>
<body>
	<div class="header-container">
		<h2 id="pageTitle">Lookup Tool for Qualys QID or CVE</h2>
	</div>
	<div>
		<h4 id="dataLoading"><div id="lastRefreshedDisplay">Source data file is loading. Please wait...</div></h4>
	</div>
	</br>
	<div>
		<h3> Displays Qualys QVS, EPSS, CVSS Base, CVSS Version and if on CISA KEV</h3>
	</div>
	</br>
    <div>
		<table id="searchTable">
			<thead>
				<tr>
					<th>
					<div>
						<h3 style="width:250px">Search By Qualys QID:</h3>
						<input type="text" id="qidSearch">
						<button onclick="searchByQID()">Search</button>
					</div>
					</th>
					<th style="width:100px"></th>
					<th>
					<th>
					<div>
						<h3 style="width:250px">Search By CVE</h3>
						<input type="text" id="cveSearch">
						<button onclick="searchByCVE()">Search</button>
					</div>
					</th>
					<th style="width:100px"></th>
					<th>
					<th>
					<div>
						<h3 style="width:220px">Display All CISA KEV</h3>
						<button id="searchCisaKevBtn" onclick="searchByCISAKEV()">Search</button>
						<h5 style="width:220px">(That exist within the Qualys KB)</h5>
					</div>
					</th>
				</tr>
			</thead>
		</table>
		<br>
		<br>
		<h4 id="loadable"> *Most column headers are sortable by clicking them*</h4>
        <!-- Results sections (hidden by default) -->
        <div id="qid-result" style="display: none;">
		<div id="row-count-display-qid"></div>
            <table>
                <thead>
                    <tr>
						<th id="header-qid">QID</th>
						<th id="header-title">Qualys Vulnerability Title</th>
						<th id="header-cve">Associated CVEs</th>
						<th id="header-qvs">QVS</th>
						<th id="header-epss">EPSS</th>
						<th id="header-cvss">CVSS baseScore</th>
						<th id="header-cvss3">CVSS Version</th>
						<th id="header-cisakev">CISA KEV</th>
                    </tr>
                </thead>
                <tbody id="qid-result-tbody">
                    <!-- Dynamic rows will be added here -->
                </tbody>
            </table>
        </div>

        <div id="cve-result" style="display: none;">
		<div id="row-count-display-cve"></div>
            <table>
                <thead>
                    <tr>
                        <th id="header-cve-cve">CVE</th>
						<th id="header-qid-cve">QID</th>
						<th id="header-title-cve">Qualys Vulnerability Title</th>
						<th id="header-qvs-cve">QVS</th>
						<th id="header-epss-cve">EPSS</th>
						<th id="header-cvss-cve">CVSS baseScore</th>
						<th id="header-cvss3-cve">CVSS Version</th>
						<th id="header-cisakev-cve">CISA KEV</th>
                    </tr>
                </thead>
                <tbody id="cve-result-tbody">
                    <!-- Dynamic rows will be added here -->
                </tbody>
            </table>
        </div>
		<!-- CISA KEV Results section (hidden by default) -->
		<div id="cisakev-result" style="display: none;">
		<div id="row-count-display-cisakev"></div>
			<table>
				<thead>
					<tr>
						<th id="header-cve-cisakev">CVE</th>
						<th id="header-qvs-cisakev">QVS</th>
						<th id="header-epss-cisakev">EPSS</th>
						<th id="header-cvss-cisakev">CVSS baseScore</th>
						<th id="header-cvss3-cisakev">CVSS Version</th>
						<th id="header-cisakev-cisakev">CISA KEV</th>


					</tr>
				</thead>
				<tbody id="cisakev-result-tbody">
					<!-- Dynamic rows will be added here for CISA KEV -->
				</tbody>
			</table>
		</div>

    </div>

    <script src="script.js"></script>
</body>
</html>
