let records = [];

// Load the CSV data on page load
window.onload = function() {
    Papa.parse('qualys-cve-epss-data.csv', {
        download: true,
        header: true,
        dynamicTyping: true,
        complete: function(results) {
            records = results.data;

            // Display "Last Updated" information
            let lastUpdatedDate = results.data[0]['column8']; // Adjust 'column8' to the actual column name if it's different
            document.getElementById("lastUpdated").innerText = `Last Updated: ${lastUpdatedDate}`;
        }
    });
}

function searchByQID() {
    let qid = document.getElementById("qidSearch").value;
    let associatedCVEs = records.filter(record => record.QID == qid);

    let highestEPSS = Math.max(...associatedCVEs.map(cve => cve.epss));
    
    // Populate the QID results section with highestEPSS and display it
    // Here you should add logic to fill out your results section with the highest EPSS score
    // ...
}

function searchByCVE() {
    let cve = document.getElementById("cveSearch").value;
    let result = records.find(record => record['CVE ID'] == cve);

    // Populate the CVE results section with result data and display it
    // Here you should add logic to fill out your results section with the corresponding data for the CVE
    // ...
}
